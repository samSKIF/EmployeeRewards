
> rest-express@1.0.0 dev
> tsx server/index.ts

Using uploads directory: /home/runner/workspace/server/uploads
Initializing Firebase app with project ID: employee-reward-fb8ea
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Initializing MongoDB for social features...
Initializing MongoDB for social features...
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Connected to MongoDB successfully
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
MongoDB indexes created successfully
MongoDB connected successfully
MongoDB social routes initialized
ðŸŽ‚ Scheduling birthday rewards job (daily at 08:00)
12:12:23 PM [express] serving on port 5000
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Browserslist: browsers data (caniuse-lite) is 8 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Cache MISS for key: departments:org:1
Cache MISS for key: locations:org:1
12:12:35 PM [express] GET /api/points/balance 304 in 389ms :: {"balance":0,"userId":11}
12:12:35 PM [express] GET /api/users/departments 304 in 399ms :: ["Engineering","Finance","HR","Inforâ€¦
12:12:35 PM [express] GET /api/users/locations 304 in 399ms :: ["London","New York","New york office"â€¦
Birthday users found: 5
Anniversary users found: 1
Total celebrations returning: 6
12:12:35 PM [express] GET /api/celebrations/today 304 in 482ms :: [{"id":2167,"user":{"id":2167,"nameâ€¦
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
/api/users/me: Returning data for user 11 (Canva Administrator, admin@canva.com)
User isAdmin value: true
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Final user object isAdmin: true
12:12:41 PM [express] GET /api/users/me 304 in 6230ms :: {"id":11,"username":"admin_canva","name":"Caâ€¦
Returning 801 users for company 1
12:12:41 PM [express] GET /api/users 304 in 6860ms :: [{"id":16,"username":"brian_lopez","name":"Briaâ€¦
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
/api/users/me: Returning data for user 11 (Canva Administrator, admin@canva.com)
User isAdmin value: true
12:12:42 PM [express] GET /api/celebrations/upcoming 304 in 7135ms :: [{"id":2122,"user":{"id":2122,"â€¦
Final user object isAdmin: true
12:12:42 PM [express] GET /api/users/me 304 in 149ms :: {"id":11,"username":"admin_canva","name":"Canâ€¦
Cache MISS for key: social:posts:org:1:limit:20:skip:0:author:all
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
/api/users/me: Returning data for user 11 (Canva Administrator, admin@canva.com)
User isAdmin value: true
12:12:42 PM [express] GET /api/social/posts 304 in 295ms :: [{"_id":"683d85dd0379183dda2ac3be","authoâ€¦
Final user object isAdmin: true
12:12:42 PM [express] GET /api/users/me 304 in 156ms :: {"id":11,"username":"admin_canva","name":"Canâ€¦
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:42 PM [express] GET /api/employee-status/users/11/statuses 304 in 152ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:43 PM [express] GET /api/employee-status/users/11/statuses 304 in 149ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:43 PM [express] GET /api/social/stats 304 in 1389ms :: {"posts":4,"comments":0,"reactions":0,"râ€¦
12:12:43 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:43 PM [express] GET /api/employee-status/users/11/statuses 304 in 151ms :: []
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:44 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:44 PM [express] GET /api/employee-status/users/11/statuses 304 in 151ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:45 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:12:45 PM [express] GET /api/employee-status/users/11/statuses 304 in 151ms :: []
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Cache MISS for key: locations:org:1
Cache MISS for key: departments:org:1
12:12:56 PM [express] GET /api/points/balance 304 in 378ms :: {"balance":0,"userId":11}
12:12:56 PM [express] GET /api/users/locations 304 in 388ms :: ["London","New York","New york office"â€¦
12:12:56 PM [express] GET /api/users/departments 304 in 397ms :: ["Engineering","Finance","HR","Inforâ€¦
Birthday users found: 5
Anniversary users found: 1
Total celebrations returning: 6
12:12:56 PM [express] GET /api/celebrations/today 304 in 468ms :: [{"id":2167,"user":{"id":2167,"nameâ€¦
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
/api/users/me: Returning data for user 11 (Canva Administrator, admin@canva.com)
User isAdmin value: true
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Returning 801 users for company 1
12:13:03 PM [express] GET /api/users 304 in 6841ms :: [{"id":16,"username":"brian_lopez","name":"Briaâ€¦
Final user object isAdmin: true
12:13:03 PM [express] GET /api/users/me 304 in 6242ms :: {"id":11,"username":"admin_canva","name":"Caâ€¦
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
/api/users/me: Returning data for user 11 (Canva Administrator, admin@canva.com)
User isAdmin value: true
12:13:03 PM [express] GET /api/celebrations/upcoming 304 in 7127ms :: [{"id":2122,"user":{"id":2122,"â€¦
Final user object isAdmin: true
12:13:03 PM [express] GET /api/users/me 304 in 152ms :: {"id":11,"username":"admin_canva","name":"Canâ€¦
Cache MISS for key: social:posts:org:1:limit:20:skip:0:author:all
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
/api/users/me: Returning data for user 11 (Canva Administrator, admin@canva.com)
User isAdmin value: true
12:13:04 PM [express] GET /api/social/posts 304 in 291ms :: [{"_id":"683d85dd0379183dda2ac3be","authoâ€¦
Final user object isAdmin: true
12:13:04 PM [express] GET /api/users/me 304 in 157ms :: {"id":11,"username":"admin_canva","name":"Canâ€¦
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:04 PM [express] GET /api/employee-status/users/11/statuses 304 in 152ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:04 PM [express] GET /api/employee-status/users/11/statuses 304 in 163ms :: []
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:05 PM [express] GET /api/social/stats 304 in 1385ms :: {"posts":4,"comments":0,"reactions":0,"râ€¦
12:13:05 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:05 PM [express] GET /api/employee-status/users/11/statuses 304 in 157ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:05 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:06 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:06 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Custom token decode - important fields:
- sub (Firebase UID): undefined
- email: admin@canva.com
- aud (audience): undefined
- iss (issuer): undefined
Failed to verify Firebase token, trying JWT: firebaseAuth is not defined
12:13:07 PM [express] GET /api/employee-status/users/11/statuses 304 in 150ms :: []
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379
Redis Client Error: connect ECONNREFUSED 127.0.0.1:6379